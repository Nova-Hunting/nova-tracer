{
  "$schema": "./pre-tool-rules.schema.json",
  "version": 1,
  "compliance_rules": {
    "bash": [
      {
        "id": "compliance-npx-install",
        "pattern": "\\bnpx\\s+install\\b",
        "reason": "npx install blocked by compliance policy",
        "enabled": false
      },
      {
        "id": "compliance-npm-global",
        "pattern": "\\bnpm\\s+install\\s+(-g|--global)\\b",
        "reason": "Global npm installs blocked by compliance policy",
        "enabled": false
      },
      {
        "id": "compliance-pip-install",
        "pattern": "\\bpip\\s+install\\s+(?!-e\\s+\\.|--editable\\s+\\.|-r\\s+requirements)",
        "reason": "Direct pip installs blocked - use requirements.txt or pyproject.toml",
        "enabled": false
      },
      {
        "id": "compliance-curl-execute",
        "pattern": "\\bcurl\\s+.*\\|\\s*(bash|sh|zsh|python)",
        "reason": "Piping curl to interpreter blocked by compliance policy",
        "enabled": false
      }
    ],
    "write": [
      {
        "id": "compliance-hardcoded-secrets",
        "pattern": "(api[_-]?key|password|secret|token)\\s*[=:]\\s*['\"][^'\"]{8,}['\"]",
        "reason": "Potential hardcoded secret detected",
        "enabled": false
      }
    ]
  },
  "protected_files": [
    {
      "id": "env-file",
      "pattern": "(^|/)\\.env$",
      "reason": "Environment file protected",
      "enabled": false
    },
    {
      "id": "env-local",
      "pattern": "(^|/)\\.env\\.local$",
      "reason": "Local environment file protected",
      "enabled": false
    },
    {
      "id": "ssh-directory",
      "pattern": "(^|/)\\.ssh/",
      "reason": "SSH directory protected",
      "enabled": false
    }
  ],
  "disable_default_rules": []
}
